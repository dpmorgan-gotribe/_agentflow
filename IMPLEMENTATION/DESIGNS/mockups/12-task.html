<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tasks - Aigentflow</title>
  <link rel="stylesheet" href="styles/main.css">
  <style>
    /* Task screen specific styles */
    .task-container {
      flex: 1;
      display: flex;
      overflow: hidden;
    }

    /* Task List Panel */
    .task-list-panel {
      width: 400px;
      background: var(--bg-secondary);
      border-right: 1px solid var(--border-primary);
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .task-list-header {
      padding: var(--spacing-md);
      border-bottom: 1px solid var(--border-primary);
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .task-list-title {
      font-size: var(--text-md);
      font-weight: 600;
      color: var(--text-primary);
    }

    .task-filters {
      display: flex;
      gap: var(--spacing-xs);
      padding: var(--spacing-sm) var(--spacing-md);
      border-bottom: 1px solid var(--border-primary);
      flex-wrap: wrap;
    }

    .task-filter {
      padding: var(--spacing-xs) var(--spacing-sm);
      background: var(--bg-tertiary);
      border: 1px solid var(--border-primary);
      border-radius: var(--radius-md);
      font-size: var(--text-xs);
      color: var(--text-muted);
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .task-filter:hover {
      border-color: var(--border-secondary);
      color: var(--text-secondary);
    }

    .task-filter.active {
      background: var(--accent-primary);
      border-color: var(--accent-primary);
      color: white;
    }

    .task-search {
      padding: var(--spacing-sm) var(--spacing-md);
      border-bottom: 1px solid var(--border-primary);
    }

    .task-list {
      flex: 1;
      overflow-y: auto;
    }

    .task-item {
      display: flex;
      gap: var(--spacing-sm);
      padding: var(--spacing-md);
      border-bottom: 1px solid var(--border-primary);
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .task-item:hover {
      background: var(--bg-tertiary);
    }

    .task-item.selected {
      background: var(--bg-tertiary);
      border-left: 3px solid var(--accent-primary);
    }

    .task-priority {
      width: 4px;
      border-radius: 2px;
      flex-shrink: 0;
    }

    .task-priority.critical { background: var(--status-error); }
    .task-priority.high { background: var(--status-warning); }
    .task-priority.medium { background: var(--accent-primary); }
    .task-priority.low { background: var(--text-muted); }

    .task-content {
      flex: 1;
      min-width: 0;
    }

    .task-header {
      display: flex;
      align-items: flex-start;
      gap: var(--spacing-sm);
      margin-bottom: var(--spacing-xs);
    }

    .task-id {
      font-family: var(--font-mono);
      font-size: var(--text-xs);
      color: var(--text-accent);
      flex-shrink: 0;
    }

    .task-title {
      font-size: var(--text-sm);
      color: var(--text-primary);
      font-weight: 500;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .task-meta {
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
      font-size: var(--text-xs);
      color: var(--text-muted);
    }

    .task-status {
      padding: 2px 6px;
      border-radius: var(--radius-sm);
      font-size: var(--text-xs);
      font-weight: 500;
    }

    .task-status.in_progress { background: var(--status-info-bg); color: var(--status-info); }
    .task-status.pending { background: var(--bg-tertiary); color: var(--text-muted); }
    .task-status.completed { background: var(--status-success-bg); color: var(--status-success); }
    .task-status.blocked { background: var(--status-error-bg); color: var(--status-error); }
    .task-status.review { background: rgba(6, 182, 212, 0.15); color: #06b6d4; }

    .task-agent {
      display: flex;
      align-items: center;
      gap: var(--spacing-xs);
    }

    .task-agent-icon {
      width: 16px;
      height: 16px;
      border-radius: var(--radius-sm);
      background: var(--accent-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 8px;
      color: white;
      font-weight: 600;
    }

    /* Task Detail Panel */
    .task-detail-panel {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    .task-detail-header {
      padding: var(--spacing-lg);
      border-bottom: 1px solid var(--border-primary);
      background: var(--bg-secondary);
    }

    .task-detail-top {
      display: flex;
      align-items: center;
      gap: var(--spacing-md);
      margin-bottom: var(--spacing-md);
    }

    .task-detail-id {
      font-family: var(--font-mono);
      font-size: var(--text-sm);
      color: var(--text-accent);
      background: var(--bg-tertiary);
      padding: var(--spacing-xs) var(--spacing-sm);
      border-radius: var(--radius-md);
    }

    .task-detail-title {
      font-size: var(--text-lg);
      font-weight: 600;
      color: var(--text-primary);
      flex: 1;
    }

    .task-detail-actions {
      display: flex;
      gap: var(--spacing-sm);
    }

    .task-info-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: var(--spacing-md);
    }

    .task-info-item {
      display: flex;
      flex-direction: column;
      gap: 2px;
    }

    .task-info-label {
      font-size: var(--text-xs);
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .task-info-value {
      font-size: var(--text-sm);
      color: var(--text-primary);
      font-weight: 500;
    }

    /* Task Body */
    .task-detail-body {
      flex: 1;
      overflow-y: auto;
      padding: var(--spacing-lg);
    }

    .task-section {
      margin-bottom: var(--spacing-xl);
    }

    .task-section-title {
      font-size: var(--text-sm);
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: var(--spacing-md);
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
    }

    .task-description {
      font-size: var(--text-sm);
      color: var(--text-secondary);
      line-height: 1.6;
      background: var(--bg-card);
      padding: var(--spacing-md);
      border-radius: var(--radius-lg);
      border: 1px solid var(--border-primary);
    }

    /* Subtasks */
    .subtask-list {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-sm);
    }

    .subtask-item {
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      padding: var(--spacing-sm) var(--spacing-md);
      background: var(--bg-card);
      border: 1px solid var(--border-primary);
      border-radius: var(--radius-md);
    }

    .subtask-checkbox {
      width: 18px;
      height: 18px;
      border: 2px solid var(--border-secondary);
      border-radius: var(--radius-sm);
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      flex-shrink: 0;
    }

    .subtask-checkbox.checked {
      background: var(--status-success);
      border-color: var(--status-success);
      color: white;
      font-size: var(--text-xs);
    }

    .subtask-title {
      flex: 1;
      font-size: var(--text-sm);
      color: var(--text-primary);
    }

    .subtask-title.completed {
      text-decoration: line-through;
      color: var(--text-muted);
    }

    .subtask-agent {
      font-size: var(--text-xs);
      color: var(--text-accent);
    }

    /* Timeline */
    .timeline {
      position: relative;
      padding-left: var(--spacing-xl);
    }

    .timeline::before {
      content: '';
      position: absolute;
      left: 8px;
      top: 0;
      bottom: 0;
      width: 2px;
      background: var(--border-primary);
    }

    .timeline-item {
      position: relative;
      padding-bottom: var(--spacing-md);
    }

    .timeline-dot {
      position: absolute;
      left: calc(-1 * var(--spacing-xl) + 4px);
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: var(--bg-tertiary);
      border: 2px solid var(--border-secondary);
    }

    .timeline-item.active .timeline-dot {
      background: var(--status-success);
      border-color: var(--status-success);
    }

    .timeline-content {
      background: var(--bg-card);
      border: 1px solid var(--border-primary);
      border-radius: var(--radius-md);
      padding: var(--spacing-sm) var(--spacing-md);
    }

    .timeline-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: var(--spacing-xs);
    }

    .timeline-action {
      font-size: var(--text-sm);
      color: var(--text-primary);
      font-weight: 500;
    }

    .timeline-time {
      font-size: var(--text-xs);
      color: var(--text-muted);
    }

    .timeline-details {
      font-size: var(--text-xs);
      color: var(--text-secondary);
    }

    /* Artifacts */
    .artifact-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
      gap: var(--spacing-sm);
    }

    .artifact-item {
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      padding: var(--spacing-sm) var(--spacing-md);
      background: var(--bg-card);
      border: 1px solid var(--border-primary);
      border-radius: var(--radius-md);
      cursor: pointer;
      transition: all 0.15s ease;
    }

    .artifact-item:hover {
      background: var(--bg-card-hover);
      border-color: var(--border-secondary);
    }

    .artifact-icon {
      width: 28px;
      height: 28px;
      border-radius: var(--radius-md);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--text-xs);
      font-weight: 600;
      flex-shrink: 0;
    }

    .artifact-icon.code { background: var(--status-info-bg); color: var(--status-info); }
    .artifact-icon.doc { background: var(--status-success-bg); color: var(--status-success); }
    .artifact-icon.design { background: rgba(236, 72, 153, 0.15); color: #ec4899; }

    .artifact-info {
      flex: 1;
      min-width: 0;
    }

    .artifact-name {
      font-size: var(--text-sm);
      color: var(--text-primary);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .artifact-meta {
      font-size: var(--text-xs);
      color: var(--text-muted);
    }

    /* Task Comments */
    .comment-list {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-md);
    }

    .comment-item {
      display: flex;
      gap: var(--spacing-sm);
    }

    .comment-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--accent-primary);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: var(--text-xs);
      font-weight: 600;
      color: white;
      flex-shrink: 0;
    }

    .comment-content {
      flex: 1;
    }

    .comment-header {
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      margin-bottom: var(--spacing-xs);
    }

    .comment-author {
      font-size: var(--text-sm);
      color: var(--text-primary);
      font-weight: 500;
    }

    .comment-time {
      font-size: var(--text-xs);
      color: var(--text-muted);
    }

    .comment-body {
      font-size: var(--text-sm);
      color: var(--text-secondary);
      line-height: 1.5;
      background: var(--bg-card);
      padding: var(--spacing-sm) var(--spacing-md);
      border-radius: var(--radius-md);
      border: 1px solid var(--border-primary);
    }

    /* Related Tasks */
    .related-tasks {
      display: flex;
      flex-direction: column;
      gap: var(--spacing-xs);
    }

    .related-task {
      display: flex;
      align-items: center;
      gap: var(--spacing-sm);
      padding: var(--spacing-sm) var(--spacing-md);
      background: var(--bg-card);
      border: 1px solid var(--border-primary);
      border-radius: var(--radius-md);
      cursor: pointer;
    }

    .related-task:hover {
      background: var(--bg-card-hover);
    }

    .related-type {
      font-size: var(--text-xs);
      color: var(--text-muted);
    }

    .related-id {
      font-family: var(--font-mono);
      font-size: var(--text-xs);
      color: var(--text-accent);
    }

    .related-title {
      flex: 1;
      font-size: var(--text-sm);
      color: var(--text-primary);
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
  </style>
</head>
<body>
  <div class="app-container">
    <!-- Header -->
    <header class="app-header">
      <div class="logo">
        <div class="logo-icon">A</div>
        <span>Aigentflow</span>
      </div>

      <nav class="nav-tabs">
        <button class="nav-tab">Kanban</button>
        <button class="nav-tab">Activity</button>
        <button class="nav-tab">Agents</button>
        <button class="nav-tab">Viewer</button>
        <button class="nav-tab">Files</button>
        <button class="nav-tab active">Tasks</button>
      </nav>

      <div class="header-right">
        <div class="status-indicator">
          <span class="status-dot"></span>
          <span>Building</span>
        </div>
        <div class="header-stats">
          <span class="header-stat">
            <span>Active:</span>
            <span class="header-stat-value">12</span>
          </span>
          <span class="header-stat">
            <span>Pending:</span>
            <span class="header-stat-value">34</span>
          </span>
        </div>
      </div>
    </header>

    <!-- Main Body -->
    <div class="app-body">
      <!-- Task List Panel -->
      <aside class="task-list-panel">
        <div class="task-list-header">
          <span class="task-list-title">Tasks</span>
          <button class="btn btn-primary btn-sm">+ New Task</button>
        </div>

        <div class="task-filters">
          <button class="task-filter active">All</button>
          <button class="task-filter">In Progress</button>
          <button class="task-filter">Pending</button>
          <button class="task-filter">Review</button>
          <button class="task-filter">Blocked</button>
          <button class="task-filter">Completed</button>
        </div>

        <div class="task-search">
          <input type="text" class="form-input" placeholder="Search tasks..." style="font-size: var(--text-xs);">
        </div>

        <div class="task-list">
          <div class="task-item selected">
            <div class="task-priority critical"></div>
            <div class="task-content">
              <div class="task-header">
                <span class="task-id">TASK-0042</span>
                <span class="task-title">Implement orchestrator routing</span>
              </div>
              <div class="task-meta">
                <span class="task-status in_progress">In Progress</span>
                <span class="task-agent">
                  <span class="task-agent-icon">AR</span>
                  Architect
                </span>
              </div>
            </div>
          </div>

          <div class="task-item">
            <div class="task-priority high"></div>
            <div class="task-content">
              <div class="task-header">
                <span class="task-id">TASK-0041</span>
                <span class="task-title">Add token budget enforcement</span>
              </div>
              <div class="task-meta">
                <span class="task-status review">Review</span>
                <span class="task-agent">
                  <span class="task-agent-icon">FE</span>
                  Frontend
                </span>
              </div>
            </div>
          </div>

          <div class="task-item">
            <div class="task-priority medium"></div>
            <div class="task-content">
              <div class="task-header">
                <span class="task-id">TASK-0040</span>
                <span class="task-title">Create decision engine tests</span>
              </div>
              <div class="task-meta">
                <span class="task-status pending">Pending</span>
                <span class="task-agent">
                  <span class="task-agent-icon">QA</span>
                  QA
                </span>
              </div>
            </div>
          </div>

          <div class="task-item">
            <div class="task-priority high"></div>
            <div class="task-content">
              <div class="task-header">
                <span class="task-id">TASK-0039</span>
                <span class="task-title">Fix agent state persistence bug</span>
              </div>
              <div class="task-meta">
                <span class="task-status blocked">Blocked</span>
                <span class="task-agent">
                  <span class="task-agent-icon">BE</span>
                  Backend
                </span>
              </div>
            </div>
          </div>

          <div class="task-item">
            <div class="task-priority low"></div>
            <div class="task-content">
              <div class="task-header">
                <span class="task-id">TASK-0038</span>
                <span class="task-title">Update API documentation</span>
              </div>
              <div class="task-meta">
                <span class="task-status completed">Completed</span>
                <span class="task-agent">
                  <span class="task-agent-icon">PM</span>
                  PM
                </span>
              </div>
            </div>
          </div>

          <div class="task-item">
            <div class="task-priority medium"></div>
            <div class="task-content">
              <div class="task-header">
                <span class="task-id">TASK-0037</span>
                <span class="task-title">Design dashboard components</span>
              </div>
              <div class="task-meta">
                <span class="task-status in_progress">In Progress</span>
                <span class="task-agent">
                  <span class="task-agent-icon">UI</span>
                  UI Designer
                </span>
              </div>
            </div>
          </div>
        </div>
      </aside>

      <!-- Task Detail Panel -->
      <main class="task-detail-panel">
        <div class="task-detail-header">
          <div class="task-detail-top">
            <span class="task-detail-id">TASK-0042</span>
            <span class="task-detail-title">Implement orchestrator routing</span>
            <div class="task-detail-actions">
              <button class="btn btn-secondary btn-sm">Edit</button>
              <button class="btn btn-primary btn-sm">Complete</button>
            </div>
          </div>
          <div class="task-info-grid">
            <div class="task-info-item">
              <span class="task-info-label">Status</span>
              <span class="task-status in_progress">In Progress</span>
            </div>
            <div class="task-info-item">
              <span class="task-info-label">Priority</span>
              <span class="task-info-value" style="color: var(--status-error);">Critical</span>
            </div>
            <div class="task-info-item">
              <span class="task-info-label">Assigned To</span>
              <span class="task-info-value" style="color: var(--text-accent);">Architect Agent</span>
            </div>
            <div class="task-info-item">
              <span class="task-info-label">Created</span>
              <span class="task-info-value">2 hours ago</span>
            </div>
          </div>
        </div>

        <div class="task-detail-body">
          <!-- Description -->
          <div class="task-section">
            <div class="task-section-title">Description</div>
            <div class="task-description">
              Implement the routing logic for the orchestrator agent. This includes:
              <br><br>
              1. Decision engine integration for 85% deterministic routing
              <br>
              2. AI fallback for complex routing decisions
              <br>
              3. Tenant isolation via AuthContext validation
              <br>
              4. Token usage tracking for budget enforcement
              <br><br>
              The router should be able to handle parallel agent execution and properly synthesize results from multiple agents.
            </div>
          </div>

          <!-- Subtasks -->
          <div class="task-section">
            <div class="task-section-title">
              Subtasks
              <span class="badge badge-neutral">3/5 completed</span>
            </div>
            <div class="subtask-list">
              <div class="subtask-item">
                <div class="subtask-checkbox checked">✓</div>
                <span class="subtask-title completed">Create Router class structure</span>
                <span class="subtask-agent">Architect</span>
              </div>
              <div class="subtask-item">
                <div class="subtask-checkbox checked">✓</div>
                <span class="subtask-title completed">Implement DecisionEngine integration</span>
                <span class="subtask-agent">Architect</span>
              </div>
              <div class="subtask-item">
                <div class="subtask-checkbox checked">✓</div>
                <span class="subtask-title completed">Add AuthContext validation</span>
                <span class="subtask-agent">Architect</span>
              </div>
              <div class="subtask-item">
                <div class="subtask-checkbox"></div>
                <span class="subtask-title">Implement token tracking</span>
                <span class="subtask-agent">Architect</span>
              </div>
              <div class="subtask-item">
                <div class="subtask-checkbox"></div>
                <span class="subtask-title">Add parallel execution support</span>
                <span class="subtask-agent">Architect</span>
              </div>
            </div>
          </div>

          <!-- Artifacts -->
          <div class="task-section">
            <div class="task-section-title">
              Artifacts
              <span class="badge badge-neutral">4 files</span>
            </div>
            <div class="artifact-grid">
              <div class="artifact-item">
                <div class="artifact-icon code">TS</div>
                <div class="artifact-info">
                  <div class="artifact-name">router.ts</div>
                  <div class="artifact-meta">v2 - 3.2 KB</div>
                </div>
              </div>
              <div class="artifact-item">
                <div class="artifact-icon code">TS</div>
                <div class="artifact-info">
                  <div class="artifact-name">decision-engine.ts</div>
                  <div class="artifact-meta">v1 - 4.1 KB</div>
                </div>
              </div>
              <div class="artifact-item">
                <div class="artifact-icon doc">MD</div>
                <div class="artifact-info">
                  <div class="artifact-name">ADR-0015.md</div>
                  <div class="artifact-meta">v1 - 2.8 KB</div>
                </div>
              </div>
              <div class="artifact-item">
                <div class="artifact-icon code">TS</div>
                <div class="artifact-info">
                  <div class="artifact-name">router.test.ts</div>
                  <div class="artifact-meta">v1 - 1.9 KB</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Timeline -->
          <div class="task-section">
            <div class="task-section-title">Activity</div>
            <div class="timeline">
              <div class="timeline-item active">
                <div class="timeline-dot"></div>
                <div class="timeline-content">
                  <div class="timeline-header">
                    <span class="timeline-action">File Modified</span>
                    <span class="timeline-time">5 min ago</span>
                  </div>
                  <div class="timeline-details">
                    <span style="color: var(--text-accent);">Architect</span> updated router.ts
                  </div>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-dot"></div>
                <div class="timeline-content">
                  <div class="timeline-header">
                    <span class="timeline-action">Subtask Completed</span>
                    <span class="timeline-time">20 min ago</span>
                  </div>
                  <div class="timeline-details">
                    Add AuthContext validation completed
                  </div>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-dot"></div>
                <div class="timeline-content">
                  <div class="timeline-header">
                    <span class="timeline-action">Status Changed</span>
                    <span class="timeline-time">1 hour ago</span>
                  </div>
                  <div class="timeline-details">
                    Pending → In Progress by <span style="color: var(--text-accent);">Orchestrator</span>
                  </div>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-dot"></div>
                <div class="timeline-content">
                  <div class="timeline-header">
                    <span class="timeline-action">Task Created</span>
                    <span class="timeline-time">2 hours ago</span>
                  </div>
                  <div class="timeline-details">
                    Created by <span style="color: var(--text-accent);">PM Agent</span>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Related Tasks -->
          <div class="task-section">
            <div class="task-section-title">Related Tasks</div>
            <div class="related-tasks">
              <div class="related-task">
                <span class="related-type">Blocks</span>
                <span class="related-id">TASK-0043</span>
                <span class="related-title">Integration testing for orchestrator</span>
                <span class="task-status pending">Pending</span>
              </div>
              <div class="related-task">
                <span class="related-type">Parent</span>
                <span class="related-id">EPIC-0012</span>
                <span class="related-title">Orchestrator System Implementation</span>
                <span class="task-status in_progress">In Progress</span>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- Bottom Command Bar -->
    <footer class="bottom-bar">
      <div class="command-input-wrapper">
        <input type="text" class="command-input" placeholder="Add comment, assign task, or change status...">
        <span class="command-shortcut">Ctrl+K</span>
      </div>
      <div class="command-actions">
        <button class="btn-command">Reassign</button>
        <button class="btn-command">Link</button>
        <button class="btn-execute">Update Status</button>
      </div>
    </footer>
  </div>
</body>
</html>
