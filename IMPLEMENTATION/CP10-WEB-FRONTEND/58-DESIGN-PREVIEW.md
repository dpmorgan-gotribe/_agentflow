# Step 58: Design Preview

> **Checkpoint:** CP10 - Web Frontend
> **Previous Step:** 57-AGENT-MONITORING.md
> **Next Step:** 59-OPENTOFU-SETUP.md (CP11)
> **Architecture Reference:** `ARCHITECTURE.md` - Design Preview

---

## Overview

**Design Preview** enables viewing and approving UI mockups generated by the UI Designer agent, with comparison views and approval workflow integration.

---

## Deliverables

1. `apps/web/src/components/features/DesignPreview.tsx` - Main preview component
2. `apps/web/src/components/features/DesignComparison.tsx` - Side-by-side comparison
3. `apps/web/src/components/features/ApprovalDialog.tsx` - Approval workflow

---

## 1. Design Preview Component

```typescript
// apps/web/src/components/features/DesignPreview.tsx

import { useState } from 'react';
import { Card, CardContent, CardHeader, CardTitle } from '../ui/card';
import { Button } from '../ui/button';
import { Tabs, TabsContent, TabsList, TabsTrigger } from '../ui/tabs';
import { Monitor, Tablet, Smartphone, Code } from 'lucide-react';

interface DesignPreviewProps {
  artifact: {
    path: string;
    content: string;
    type: 'mockup' | 'stylesheet';
  };
  onApprove: () => void;
  onReject: (reason: string) => void;
}

export function DesignPreview({ artifact, onApprove, onReject }: DesignPreviewProps) {
  const [viewport, setViewport] = useState<'desktop' | 'tablet' | 'mobile'>('desktop');
  const [showCode, setShowCode] = useState(false);

  const viewportWidths = {
    desktop: '100%',
    tablet: '768px',
    mobile: '375px',
  };

  return (
    <Card>
      <CardHeader className="flex flex-row items-center justify-between">
        <CardTitle>Design Preview</CardTitle>
        <div className="flex items-center space-x-2">
          <Button
            variant={viewport === 'desktop' ? 'default' : 'ghost'}
            size="icon"
            onClick={() => setViewport('desktop')}
          >
            <Monitor className="w-4 h-4" />
          </Button>
          <Button
            variant={viewport === 'tablet' ? 'default' : 'ghost'}
            size="icon"
            onClick={() => setViewport('tablet')}
          >
            <Tablet className="w-4 h-4" />
          </Button>
          <Button
            variant={viewport === 'mobile' ? 'default' : 'ghost'}
            size="icon"
            onClick={() => setViewport('mobile')}
          >
            <Smartphone className="w-4 h-4" />
          </Button>
          <Button
            variant={showCode ? 'default' : 'ghost'}
            size="icon"
            onClick={() => setShowCode(!showCode)}
          >
            <Code className="w-4 h-4" />
          </Button>
        </div>
      </CardHeader>
      <CardContent>
        <Tabs defaultValue="preview">
          <TabsList>
            <TabsTrigger value="preview">Preview</TabsTrigger>
            <TabsTrigger value="code">Code</TabsTrigger>
          </TabsList>

          <TabsContent value="preview" className="mt-4">
            <div
              className="mx-auto border rounded-lg overflow-hidden bg-white"
              style={{ width: viewportWidths[viewport], maxWidth: '100%' }}
            >
              <iframe
                srcDoc={artifact.content}
                className="w-full h-96"
                title="Design Preview"
                sandbox="allow-scripts"
              />
            </div>
          </TabsContent>

          <TabsContent value="code" className="mt-4">
            <pre className="p-4 bg-gray-900 text-gray-100 rounded-lg overflow-x-auto text-sm">
              <code>{artifact.content}</code>
            </pre>
          </TabsContent>
        </Tabs>

        <div className="flex justify-end space-x-2 mt-4">
          <Button variant="outline" onClick={() => onReject('Needs revision')}>
            Request Changes
          </Button>
          <Button onClick={onApprove}>
            Approve Design
          </Button>
        </div>
      </CardContent>
    </Card>
  );
}
```

---

## Validation Checklist

```
□ Design Preview (Step 58)
  □ Mockups render in iframe
  □ Viewport switching works
  □ Code view displays
  □ Approval flow works
  □ Comparison view works
  □ Tests pass
```

---

## Next Step

Proceed to **59-OPENTOFU-SETUP.md** (CP11) to begin infrastructure setup.
